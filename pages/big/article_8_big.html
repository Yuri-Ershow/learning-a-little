<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <meta name="description" content="Подробно описан процесс создания первого приложения в микрофреймворке Flask.">
    <meta name="keywords" content="Программирование, микрофреймворк, Flask, первое Flask-приложение, виртуальная среда">
    <meta name="Author" content="Юрий Ершов">
    <meta name="Copyright" content="Юрий Ершов">
    <title>Учимся понемногу. Статья 8</title>

    <link rel="stylesheet" href="../../css/style_articles_big.css">

</head>

<body>
    <div class="page">
        <header class="header">
            <div class="article_title">
                <h1>8. Создаем первое Flask-приложение.</h1>
            </div>
            
            <div class="wrapper_button">
                <a href="../../pages/article_8.html">
                    <div class="close"></div>
                </a>
            </div>
          
        </header>
        <main class="main">
            <div class="wrapper_main_content">
                <div class="articles_text">

                            <div class="img_art">
                                <img src="../../img/img-articles/img_art_8/img_flask_2.jpg" alt="Картинка Flask">
                            </div>
                            <p>
                                После создания виртуальной среды и установки в ней фреймворка Flask (см. статью "Установка микрофреймворка Flask в ОС Windows") в папке виртуальной среды появятся папки и файлы, образующие структуру приложения. Рассмотрим их.
                            </p>
                            <p>
                                В нашем простейшем минимальном приложении, которое мы назвали - <span>first_flask_app</span>, после генерирования виртуальной среды, в ее папке <span>my_flask_env</span> автоматически создаются папки: <span>Lib, Scripts</span> и файл конфигурации <span>pyvenv.cfg</span>.
                            </p>
                            <div class="code">
                                <span>/first_flask_app<br>
                                &#160 -/my_flask_env <br>
                                &#160 &#160 - /Lib <br>
                                &#160 &#160 - /Scripts <br>
                                &#160 &#160 - pyvenv.cfg</span>
                            </div>
                            
                            <p>
                               В папке <span>Lib</span> расположены библиотеки, которые используются на сервере во время развертывания, папка <span>Scripts</span> содержит копии <span>Python, pip и Flask</span>, а также данные об активации и деактивации виртуальной среды.
                             </p>
                             <p>
                                Строгих правил для структуры Flask-приложения нет, и она может включать в себя разные комбинации файлов и папок, но папки <span>static</span> и <span>templates</span> должны присутствовать в любом приложении. Папка <span>static</span> содержит файлы и папки, которые в приложении не изменяются или изменяются редко. Например, папка <span>css</span> c таблицами стилей для приложения, и папка <span>images</span> c картинками приложения. Папка <span>templates</span> содержит шаблоны с расширениями <span>.html</span>. Flask-приложение ищет соответствующие файлы в этих папках по умолчанию. Папки <span>static</span> и <span>templates</span> создаются разработчиком самостоятельно.            
                                <br>Также самостоятельно создается главный файл приложения app.py, которым приложение запускается. 
                             </p>
                             <p>
                                В результате получаем примерно такую структуру нашего приложения.
                             </p>
                             <div class="code">
                                <span>/first_flask_app <br>
                                    &#160 -/my_flask_env<br>
                                    &#160 &#160 -/Lib<br>
                                    &#160 &#160 -/Scripts<br>
                                    &#160 &#160 -/sources<br>
                                    &#160 &#160 -/static<br>
                                    &#160 &#160 &#160 -/css<br>
                                    &#160 &#160 &#160 -/images<br>
                                    &#160 &#160 &#160 -/js<br>
                                    &#160 &#160 &#160 -/templates<br>
                                    &#160 &#160 &#160 &#160 - index.html<br>
                                    &#160 &#160 &#160 &#160 - page_2.html<br>
                                    &#160 &#160 &#160 &#160 - page_3.html<br>
                                       ………………………………………<br>
                                    &#160 &#160 - app.py<br>
                                    &#160 &#160 - pyvenv.cfg<br></span>      
                             </div>
                             <p>
                                 Ну и создадим файл <span>app.py</span>. Как уже говорилось, он будет находится в виртуальной среде<span>my_flask_env</span>.  Если создавать файл в терминале (чтобы не "прыгать " по разным окнам), в командной строке пишем следующий код: 
                             </p>
                             <div class="code">
                                 <span>NUL > app.py</span>
                             </div>
                             <p>
                                 Затем открываем этот файл в своем текстовом редакторе и вводим следующий код:
                             </p>
                             <div class="code"><span>
                                 app.py<br><br>    

                                 from flask import Flask<br><br>     

                                 app = Flask(__name__)<br><br>    

                                 @app.route('/')<br> 
                                 def  index():<br>  
                                     &#160 &#160 return 'Hello, Flask!' <br> 

                                 if __name__ == '__main__': <br> 
                                 &#160 &#160 app.run(debug=True)</span>
                             </div>
                             <p>
                                 Первая строка <span>from flask import Flask</span> загружает класс <span>Flask</span>. Он представляет собой WSGI-приложение и является центральным объектом в приложении. WSGI - это стандарт интерфейса веб-сервера Python, определенный  в PEP 333. Можно думать об WSGI, как об установщике поведения и методов, которые когда выполняются, позволяют Web-приложению работать с большим количеством Web серверов. Flask управляет всеми выполнениями деталей, поэтому можно сосредоточиться на написании приложения, не отвлекаясь на эти детали.
                             </p>
                             <div class="code">
                                 <span>app = Flask(__name__)</span>
                             </div>
                             <p>
                                 В этой строке создается экземпляр приложения в переменной <span>app</span> с именем нашего модуля. Переменная app, может быть любой, однако, название <span>app</span> - принято по всеобщему соглашению для большинства Flask-приложений. Мы ссылаемся на имя текущего модуля <span>__name__</span>, так что приложение может найти требуемые ресурсы, внутри текущей папки. Это будет важно позже, если мы будем изменять шаблоны или обрабатывать статические файлы.
                             </p>
                             <p>
                                 В следующей строке кода - <span>@app.route('/')</span> - это Python декоратор из переменной app, определенной выше. Этот декоратор оборачивает функцию представления <span>index()</span>, чтобы направлять запросы для определенного URL-адреса на конкретное представление. <span>Index</span> выбран, как имя для функции, традиционно представляющей первую страницу приложения, которую использует сервер. 
                             </p>
                             <p>
                                 В строках
                             </p>
                             <div class="code">
                                 <span>def index():<br>
                                  &#160 &#160 return 'Hello, Flask!'</span> 
                             </div>
                             <p>
                                  мы инструктируем наше приложение о всех запросах от слэша (/)- корневого URL -  для функции представления <span>index()</span>. <span>Index()</span> – это просто функция, которая возвращает какой-то ответ. Когда мы открываем браузер, и набираем корневой URL нашего приложения, Flask вызывает функцию представления и отправляет значение <span>return</span> в браузер. У функции<span>index()</span> нет аргументов. Она возвращает объект простой строки.
                             </p>
                             <p>
                                  Рассмотрим следующие строки:
                             </p>
                             <div class="code">
                                 <span>if __name__ == '__main__':<br>
                                 &#160 &#160 app.run(debug=True)</span> 
                             </div>
                             <p>
                                 В них выполняеnся наше приложение с использованием внутреннего сервера разработки в режиме отладки (<span>debug=True</span>). Иструкция </span>if</span> запускает сервер только в том случае, если мы запускаем наше приложение из командной строки командой - <span>python app.py</span>. В случае, когда приложение импортируется из другого файла, как это делается на рабочем сервере, отладочный сервер не запустится. 
                             </p>
                             <p>
                                 В режиме отладки в браузере и в терминале выдается подробная отладочная информация от ошибках. Поэтому после завершения отладки нужно поменять значение - <span>debug</span> c  <span>True (debug=True)</span> на <span>False (debug=False)</span>, чтобы отладочная информация не выводилась.
                             </p>
                             <p>
                                 После того, как код написан и всячески проверен, возвращаемся в командную строку и выходим из интерпретатора Python обратно в виртуальную среду<span> my_flask_env</span> при помощи команды - <span>exit()</span> или <span>Ctrl-Z + Return</span>. 
                             </p>
                             <p>
                                 Дальше - самое интересное - запускаем файл <span>app.py</span> стандартной командой - </span>python app.py</span>:
                             </p>
                             <div class="code_1">                      
                                 <span>(my_flask_env)c:\My_flask\first_flask_app\my_flask_env>python app.py</span>
                             </div>
                             <p>
                                 В результате в терминале должны появиться строчки, среди которых:
                             </p>
                             <div class="code_1">
                                 <span>* Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)</span>
                             </div>
                             <p>
                                 Если она есть, значит - локальный сервер работает...
                             </p>
                             <p>
                                 ВСЁ! Запускаем браузер по адресу локального хоста <span>127.0.0.1</span>, используя порт по умолчанию – 5000-ный. Номер порта можно переопределить, если он уже используется другим приложением.
                             </p>
                             <p>
                                 После перехода по этой ссылке, если все сделано правильно, в браузере на пустой белой странице должно появиться сообщение:   
                             </p>
                             <h2>
                                 «Hello, Flask!»
                             </h2>
                             <p>
                                 Ну и, …получаем удовольствие от свершенных трудов тяжких...
                             </p>                   

                </div>
                <div class="time">
                    28.09.21
                </div>
            </div>
        </main>
        
    </div>

    <script src="js/main.js"></script>

</body>

</html>